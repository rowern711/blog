---
layout: default
---
<section class="entry archive">
  <h1>Archive</h1>
  <p>Leaf through every entry, or filter by pillar or topic.</p>
  <div class="filter-bar">
    <div class="filter-group">
      <strong>Pillars:</strong>
      {% for pillar in site.pillars %}
      <a class="topic-chip" href="{{ '/archive.html?pillar=' | append: pillar | relative_url }}">{{ pillar | capitalize }}</a>
      {% endfor %}
    </div>
    <div class="filter-group">
      <strong>Topics:</strong>
      {% assign topics = site.posts | map: 'topics' | join: ',' | split: ',' | uniq | sort %}
      {% for topic in topics %}
        {% unless topic == '' %}
        <a class="topic-chip" href="{{ '/archive.html?topic=' | append: topic | relative_url }}">{{ topic | replace: '-', ' ' | capitalize }}</a>
        {% endunless %}
      {% endfor %}
    </div>
    <div class="filter-summary" id="filter-summary">Showing all posts.</div>
  </div>
  <div class="archive-list">
    {% assign sorted_posts = site.posts | sort: 'date' | reverse %}
    {% for post in sorted_posts %}
    <article class="archive-row" data-pillar="{{ post.pillar }}" data-topics="{{ post.topics | join: ',' }}">
      <h2><a href="{{ post.url | relative_url }}">{{ post.title }}</a></h2>
      <p class="author">{{ post.date | date: '%B %d, %Y' }} &mdash; {{ post.pillar | capitalize }}</p>
      <p class="post-excerpt">{{ post.excerpt | strip_html | truncate: 180 }}</p>
      <div class="post-tags">
        <strong>{{ post.pillar | upcase }}</strong>
        {% if post.topics %}
          &middot;
          {% for topic in post.topics %}
            <a href="{{ '/topic/' | append: topic | append: '/' | relative_url }}">{{ topic }}</a>{% unless forloop.last %}, {% endunless %}
          {% endfor %}
        {% endif %}
      </div>
    </article>
    {% endfor %}
  </div>
</section>
<script>
(function() {
  const params = new URLSearchParams(window.location.search);
  const pillarParam = params.get('pillar');
  const topicParam = params.get('topic');
  const rows = Array.from(document.querySelectorAll('.archive-row'));
  const summary = document.getElementById('filter-summary');
  if (!rows.length) return;
  let label = 'Showing all posts.';
  if (pillarParam) {
    rows.forEach(row => {
      const matches = row.dataset.pillar === pillarParam;
      row.hidden = !matches;
    });
    label = 'Filtered by pillar: ' + pillarParam;
  }
  if (topicParam) {
    rows.forEach(row => {
      const topics = row.dataset.topics.split(',').map(t => t.trim());
      const matches = topics.includes(topicParam);
      row.hidden = !matches;
    });
    label = 'Filtered by topic: ' + topicParam;
  }
  summary.textContent = label;
})();
</script>
